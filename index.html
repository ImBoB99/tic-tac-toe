<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Tic Tac Toe</title>
</head>

<body>

    <div class="display-container"></div>

    <script>

        const Game = (function () {

            const player1 = { name: "Lala", marker: "X", wins: 0, };
            const player2 = { name: "Hope", marker: "O", wins: 0, };

            const playGame = (playerOne, playerTwo) => {

                let currentPlayer = playerOne;

                while (true) {
                    let index = prompt(`${currentPlayer.name} input index to mark`);

                    if (Gameboard.setMarker(currentPlayer, index) !== "spot taken") {
                        Gameboard.setMarker(currentPlayer, index)
                    } else {
                        continue;
                    }


                    if (checkWin(currentPlayer) === true) {
                        console.log("Check win worked")
                        break;
                    }

                    currentPlayer = currentPlayer === playerOne ? playerTwo : playerOne;

                    Gameboard.logBoard();
                }
            };

            const checkRows = function (player) {
                if (Gameboard.getBoard()[0] === player.marker && Gameboard.getBoard()[1] === player.marker && Gameboard.getBoard()[2] === player.marker) {
                    return true;
                }
                if (Gameboard.getBoard()[3] === player.marker && Gameboard.getBoard()[4] === player.marker && Gameboard.getBoard()[5] === player.marker) {
                    return true;
                }
                if (Gameboard.getBoard()[6] === player.marker && Gameboard.getBoard()[7] === player.marker && Gameboard.getBoard()[8] === player.marker) {
                    return true;
                }
            }

            const checkColumns = function (player) {
                if (Gameboard.getBoard()[0] === player.marker && Gameboard.getBoard()[3] === player.marker && Gameboard.getBoard()[6] === player.marker) {
                    return true;
                }
                if (Gameboard.getBoard()[1] === player.marker && Gameboard.getBoard()[4] === player.marker && Gameboard.getBoard()[7] === player.marker) {
                    return true;
                }
                if (Gameboard.getBoard()[2] === player.marker && Gameboard.getBoard()[5] === player.marker && Gameboard.getBoard()[8] === player.marker) {
                    return true;
                }
            }

            const checkDiagonals = function (player) {
                if (Gameboard.getBoard()[0] === player.marker && Gameboard.getBoard()[4] === player.marker && Gameboard.getBoard()[8] === player.marker) {
                    return true;
                }
                if (Gameboard.getBoard()[2] === player.marker && Gameboard.getBoard()[4] === player.marker && Gameboard.getBoard()[6] === player.marker) {
                    return true;
                }
            }


            const checkWin = function (player) {
                if (checkRows(player) || checkColumns(player) || checkDiagonals(player)) {
                    player.wins++;
                    console.log(`${player.name} has won the game, wins: ${player.wins}`);
                    Gameboard.resetBoard();
                    return true;  // Game ends after win
                } else if (!Gameboard.getBoard().includes(null)) {  // Check for tie
                    console.log("It was a tie");
                    Gameboard.resetBoard();
                    return true;  // Game ends after tie
                }
                return false;  // Game continues if no win or tie
            }

            return { player1, player2, checkWin, playGame };
        })();

        const Gameboard = (function () {
            let board = [null, "X", "O",
                "X", "X", "X",
                "X", "X", "X"
            ];

            const setMarker = (player, index) => {
                if (board[index] === null) {
                    board[index] = player.marker
                } else {
                    return "spot taken"
                }
            };

            const getBoard = () => board;

            const logBoard = () => console.log(board);

            const resetBoard = () => board = [null, null, null, null, null, null, null, null, null];

            return { setMarker, getBoard, logBoard, resetBoard }
        })();

        const displayController = (function () {

            const displayContainer = document.querySelector(".display-container");

            const displayBoard = () => {
                Gameboard.getBoard().forEach((item, index) => {
                    console.log(item)
                    let boardCell = document.createElement("div");
                    boardCell.dataset.cell = index;
                    boardCell.classList.add("board-cell");
                    boardCell.textContent = item;
                    displayContainer.appendChild(boardCell);

                    boardCell.addEventListener("click", function (e) {
                        console.log(e.target)
                    })
                })
            };

            return {displayBoard}

        })()


        displayController.displayBoard();
       // Game.playGame(Game.player1, Game.player2)


    </script>

</body>

</html>